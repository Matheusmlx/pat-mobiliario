{"remainingRequest":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/babel-loader/lib/index.js!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/patrimonios/patrimonio/ficha-patrimonios/movimentacoes/FichaPatrimonioMovimentacoes.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/patrimonios/patrimonio/ficha-patrimonios/movimentacoes/FichaPatrimonioMovimentacoes.vue","mtime":1614091470412},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { createNamespacedHelpers, mapActions } from 'vuex';\nimport _ from 'lodash';\nimport { actionTypes } from '@/core/constants';\nimport AzHasPermissions from '@azinformatica/loki/src/utils/AzHasPermissions';\nimport BotaoVerMais from '@/views/components/botoes/BotaoVerMais';\nimport BotaoVerMenos from '@/views/components/botoes/BotaoVerMenos';\n\nvar _createNamespacedHelp = createNamespacedHelpers('rotulosPersonalizados'),\n    mapGetters = _createNamespacedHelp.mapGetters;\n\nexport default {\n  name: 'FichaPatrimonioMovimentacoes',\n  components: {\n    BotaoVerMenos: BotaoVerMenos,\n    BotaoVerMais: BotaoVerMais\n  },\n  props: {\n    dadosIncorporacao: {\n      type: Object,\n      required: true\n    }\n  },\n  data: function data() {\n    return {\n      movimentacoes: [],\n      todasMovimentacoes: [],\n      cincoMovimentacoes: [],\n      incorporacao: {},\n      situacoesSemAlteracao: ['FINALIZADO', 'DEVOLVIDO', 'ESTORNADO', 'PARCIALMENTE_ESTORNADO'],\n      nomeTelaDadosGerais: 'MOVIMENTACAO_INTERNA_DADOS_GERAIS',\n      nomeTelaIncorporacao: 'INCORPORACAO_DADOS_GERAIS'\n    };\n  },\n  watch: {\n    'dadosIncorporacao': function dadosIncorporacao() {\n      this.preencherIncorporacao();\n      this.buscarMovimentacoes();\n    }\n  },\n  mounted: function mounted() {\n    this.buscarIncorporacao();\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters(['getDistribuicaoValidado'])), {}, {\n    verificaPermissaoEdicao: function verificaPermissaoEdicao() {\n      return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Normal']);\n    },\n    verificaPermissaoEdicaoMovimentacao: function verificaPermissaoEdicaoMovimentacao() {\n      return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Movimentacoes']);\n    },\n    mostraVerMais: function mostraVerMais() {\n      return this.movimentacoes.length <= 5;\n    },\n    mostraBotoes: function mostraBotoes() {\n      return this.todasMovimentacoes.length > 5;\n    }\n  }),\n  methods: _objectSpread(_objectSpread({}, mapActions([actionTypes.PATRIMONIO.BUSCAR_TODAS_MOVIMENTACOES, actionTypes.MOVIMENTACAO_INTERNA.ITEM.BUSCAR_QUATIDADE_ITENS_ADICIONADOS_MOVIMENTACAO_INTERNA])), {}, {\n    buscarIncorporacao: function buscarIncorporacao() {\n      this.$emit('buscarIncorporacao');\n    },\n    preencherIncorporacao: function preencherIncorporacao() {\n      this.incorporacao = _.cloneDeep(this.dadosIncorporacao);\n    },\n    redirecionaRegistroIncorporacao: function redirecionaRegistroIncorporacao(item) {\n      if (this.verificaPermissaoEdicao) {\n        this.$router.push({\n          name: 'VisualizarRegistroIncorporacao',\n          params: {\n            incorporacaoId: item.incorporacaoId\n          }\n        });\n      } else {\n        this.$router.push({\n          name: 'VisualizarRegistroIncorporacaoVisualizacao',\n          params: {\n            incorporacaoId: item.incorporacaoId\n          }\n        });\n      }\n    },\n    redirecionaRegistroMovimentacao: function () {\n      var _redirecionaRegistroMovimentacao = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(item) {\n        var id;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!this.verificaPermissaoEdicaoMovimentacao) {\n                  _context.next = 21;\n                  break;\n                }\n\n                id = item.id;\n\n                if (!(item.situacao === 'FINALIZADO' || item.situacao === 'AGUARDANDO_DEVOLUCAO' || item.situacao === 'DEVOLVIDO')) {\n                  _context.next = 7;\n                  break;\n                }\n\n                _context.next = 5;\n                return this.$router.push({\n                  name: 'VisualizarRegistroMovimentacaoInterna',\n                  params: {\n                    movimentacaoInternaId: id\n                  }\n                });\n\n              case 5:\n                _context.next = 21;\n                break;\n\n              case 7:\n                if (!(item.situacao === 'EM_ELABORACAO')) {\n                  _context.next = 21;\n                  break;\n                }\n\n                _context.next = 10;\n                return this.verificarSeCamposObrigatoriosPreenchidos(item);\n\n              case 10:\n                if (!_context.sent) {\n                  _context.next = 20;\n                  break;\n                }\n\n                _context.next = 13;\n                return this.verificarSePossuiItensNaMovimentacao(id);\n\n              case 13:\n                if (!_context.sent) {\n                  _context.next = 17;\n                  break;\n                }\n\n                this.redirecionaParaDocumentos(id);\n                _context.next = 18;\n                break;\n\n              case 17:\n                this.redirecionaParaItens(id);\n\n              case 18:\n                _context.next = 21;\n                break;\n\n              case 20:\n                this.redirecionaParaDadosGerais(id);\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function redirecionaRegistroMovimentacao(_x) {\n        return _redirecionaRegistroMovimentacao.apply(this, arguments);\n      }\n\n      return redirecionaRegistroMovimentacao;\n    }(),\n    verificarSeCamposObrigatoriosPreenchidos: function () {\n      var _verificarSeCamposObrigatoriosPreenchidos = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(item) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(item.tipo === 'DISTRIBUICAO')) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                _context2.next = 3;\n                return this.getDistribuicaoValidado(item, this.nomeTelaDadosGerais, this.nomeTelaIncorporacao);\n\n              case 3:\n                return _context2.abrupt(\"return\", _context2.sent);\n\n              case 4:\n                return _context2.abrupt(\"return\", false);\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function verificarSeCamposObrigatoriosPreenchidos(_x2) {\n        return _verificarSeCamposObrigatoriosPreenchidos.apply(this, arguments);\n      }\n\n      return verificarSeCamposObrigatoriosPreenchidos;\n    }(),\n    verificarSePossuiItensNaMovimentacao: function () {\n      var _verificarSePossuiItensNaMovimentacao = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id) {\n        var resultado;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.buscarQuantidadeItensAdicionadosMovimentacaoInterna(id);\n\n              case 2:\n                resultado = _context3.sent;\n                return _context3.abrupt(\"return\", resultado ? resultado.quantidadeItens > 0 : false);\n\n              case 4:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function verificarSePossuiItensNaMovimentacao(_x3) {\n        return _verificarSePossuiItensNaMovimentacao.apply(this, arguments);\n      }\n\n      return verificarSePossuiItensNaMovimentacao;\n    }(),\n    redirecionaParaDocumentos: function redirecionaParaDocumentos(id) {\n      this.$router.push({\n        name: 'MovimentacaoInternaEdicaoDocumentos',\n        params: {\n          movimentacaoInternaId: id\n        }\n      });\n    },\n    redirecionaParaItens: function redirecionaParaItens(id) {\n      this.$router.push({\n        name: 'MovimentacaoInternaEdicaoItens',\n        params: {\n          movimentacaoInternaId: id\n        }\n      });\n    },\n    redirecionaParaDadosGerais: function redirecionaParaDadosGerais(id) {\n      this.$router.push({\n        name: 'MovimentacaoInternaEdicaoDadosGerais',\n        params: {\n          movimentacaoInternaId: id\n        }\n      });\n    },\n    buscarMovimentacoes: function () {\n      var _buscarMovimentacoes = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var retorno;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.buscarTodasMovimentacoes(this.$route.params.patrimonioId);\n\n              case 2:\n                retorno = _context4.sent;\n\n                if (!this.incorporacao.isEmpty) {\n                  retorno.items.push(this.incorporacao);\n                }\n\n                if (retorno && retorno.items.length > 0) {\n                  this.verificaQuantidadeMovimentacoes(retorno.items);\n                }\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function buscarMovimentacoes() {\n        return _buscarMovimentacoes.apply(this, arguments);\n      }\n\n      return buscarMovimentacoes;\n    }(),\n    verificaQuantidadeMovimentacoes: function verificaQuantidadeMovimentacoes(movimentacoes) {\n      this.todasMovimentacoes = movimentacoes;\n      this.cincoMovimentacoes = movimentacoes.slice(0, 5);\n\n      if (movimentacoes.length > 5) {\n        this.movimentacoes = this.cincoMovimentacoes;\n      } else {\n        this.movimentacoes = this.todasMovimentacoes;\n      }\n    },\n    tratarEventoVerMais: function tratarEventoVerMais() {\n      this.movimentacoes = this.todasMovimentacoes;\n    },\n    tratarEventoVerMenos: function tratarEventoVerMenos() {\n      this.movimentacoes = this.cincoMovimentacoes;\n    },\n    retornaIcone: function retornaIcone(item) {\n      return this.situacoesSemAlteracao.includes(item.situacao) ? 'done' : 'priority_high';\n    },\n    retornaCor: function retornaCor(item) {\n      return this.situacoesSemAlteracao.includes(item.situacao) ? 'primary' : 'orange';\n    },\n    movimentacaoIncorporacao: function movimentacaoIncorporacao(item) {\n      return item.tipo === 'INCORPORACAO';\n    },\n    movimentacaoEmElaboracao: function movimentacaoEmElaboracao(item) {\n      return item.situacao === 'EM_ELABORACAO';\n    },\n    retornaData: function retornaData(item) {\n      return item.situacao === 'FINALIZADO' || item.situacao === 'DEVOLVIDO' ? item.dataFinalizacao : item.dataCriacao;\n    }\n  })\n};",{"version":3,"sources":["FichaPatrimonioMovimentacoes.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"corpo-conteiner\">\n            <v-col md=\"7\" sm=\"12\" xs=\"12\" class=\"alinhamentoTimeline\">\n                <v-timeline>\n                    <v-timeline-item\n                        v-for=\"item in movimentacoes\"\n                        :key=\"item.dataFinalizacao\"\n                        :color=\"retornaCor(item)\"\n                        :icon=\"retornaIcone(item)\"\n                        fill-dot small>\n                        <template v-slot:opposite>\n                            <span\n                                class=\"text-left text--darken-1 grey--text text-body-2\">{{ retornaData(item) | azDate() }}</span>\n                        </template>\n                        <v-card v-if=\"movimentacaoIncorporacao(item)\"\n                            width=\"350\"\n                                @click=\"redirecionaRegistroIncorporacao(item)\">\n                            <v-card-title\n                                class=\"font-weight-bold text-body-1 pb-0 text--darken-1 primary--text\">\n                                {{ item.tipo | azEnum(tipoMovimentacoes) }}\n                            </v-card-title>\n                            <v-card-text class=\"text-left text--darken-1 grey--text\">\n                                <span class=\"font-weight-bold\">N° Nota: </span>{{ item.numeroNotaLancamentoContabil | textoSemValorSimples }}<br/>\n                                <span class=\"font-weight-bold\">Valor Total: </span>{{ item.valorTotal | valorParaReal }}<br/>\n                                <span class=\"font-weight-bold\">Situação: </span>{{ item.situacao | azEnum(situacoesIncorporacao) }}<br/>\n                            </v-card-text>\n                        </v-card>\n\n                        <v-card width=\"350\"\n                                v-else\n                                @click=\"redirecionaRegistroMovimentacao(item)\">\n                            <v-card-title\n                                class=\"font-weight-bold text-body-1 pb-0 text--darken-1\" :class=\"[movimentacaoEmElaboracao(item)? 'orange--text': 'primary--text']\">\n                                {{ item.tipo | azEnum(tipoMovimentacoes) }}\n                            </v-card-title>\n                            <v-card-text class=\"text-left text--darken-1 grey--text\">\n                                <span class=\"font-weight-bold\">De: </span>{{ item.setorOrigem | textoSemValorSimples }}<br/>\n                                <span class=\"font-weight-bold\">Para: </span>{{ item.setorDestino | textoSemValorSimples }}<br/>\n                                <span class=\"font-weight-bold\">Situação: </span>{{ item.situacao | azEnum(situacoesMovimentacaoInterna) }}<br/>\n                            </v-card-text>\n                        </v-card>\n                    </v-timeline-item>\n                </v-timeline>\n            </v-col>\n        <v-col v-if=\"mostraBotoes\" md=\"12\" sm=\"12\" xs=\"12\" class=\"d-flex justify-center align-center\">\n            <botao-ver-mais v-if=\"mostraVerMais\" @verMais=\"tratarEventoVerMais\" />\n            <botao-ver-menos v-else @verMenos=\"tratarEventoVerMenos\" />\n        </v-col>\n    </div>\n</template>\n\n<script>\n    import {createNamespacedHelpers, mapActions} from 'vuex'\n    import _ from 'lodash'\n    import {actionTypes} from '@/core/constants'\n    import AzHasPermissions from '@azinformatica/loki/src/utils/AzHasPermissions'\n    import BotaoVerMais from '@/views/components/botoes/BotaoVerMais'\n    import BotaoVerMenos from '@/views/components/botoes/BotaoVerMenos'\n\n    const {mapGetters} = createNamespacedHelpers('rotulosPersonalizados')\n\n    export default {\n        name: 'FichaPatrimonioMovimentacoes',\n        components: {BotaoVerMenos, BotaoVerMais},\n        props: {\n            dadosIncorporacao: {\n                type: Object,\n                required: true\n            }\n        },\n        data() {\n            return {\n                movimentacoes: [],\n                todasMovimentacoes: [],\n                cincoMovimentacoes: [],\n                incorporacao:{},\n                situacoesSemAlteracao: ['FINALIZADO','DEVOLVIDO','ESTORNADO','PARCIALMENTE_ESTORNADO'],\n                nomeTelaDadosGerais: 'MOVIMENTACAO_INTERNA_DADOS_GERAIS',\n                nomeTelaIncorporacao: 'INCORPORACAO_DADOS_GERAIS'\n            }\n        },\n        watch: {\n            'dadosIncorporacao'() {\n                this.preencherIncorporacao()\n                this.buscarMovimentacoes()\n            }\n        },\n        mounted() {\n            this.buscarIncorporacao()\n        },\n        computed: {\n            ...mapGetters(['getDistribuicaoValidado']),\n            verificaPermissaoEdicao() {\n                return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Normal'])\n            },\n            verificaPermissaoEdicaoMovimentacao() {\n                return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Movimentacoes'])\n            },\n            mostraVerMais(){\n                return this.movimentacoes.length <= 5\n            },\n            mostraBotoes(){\n                return this.todasMovimentacoes.length > 5\n            }\n        },\n        methods: {\n            ...mapActions([\n                actionTypes.PATRIMONIO.BUSCAR_TODAS_MOVIMENTACOES,\n                actionTypes.MOVIMENTACAO_INTERNA.ITEM.BUSCAR_QUATIDADE_ITENS_ADICIONADOS_MOVIMENTACAO_INTERNA\n            ]),\n            buscarIncorporacao() {\n                this.$emit('buscarIncorporacao')\n            },\n            preencherIncorporacao() {\n                this.incorporacao = _.cloneDeep(this.dadosIncorporacao)\n            },\n            redirecionaRegistroIncorporacao(item) {\n                if(this.verificaPermissaoEdicao){\n                    this.$router.push({name: 'VisualizarRegistroIncorporacao', params:{incorporacaoId:item.incorporacaoId}})\n                }else{\n                    this.$router.push({name: 'VisualizarRegistroIncorporacaoVisualizacao', params: {incorporacaoId: item.incorporacaoId}})\n                }\n            },\n            async redirecionaRegistroMovimentacao(item) {\n                if (this.verificaPermissaoEdicaoMovimentacao) {\n                    const id = item.id\n                    if (item.situacao === 'FINALIZADO' || item.situacao === 'AGUARDANDO_DEVOLUCAO' || item.situacao === 'DEVOLVIDO') {\n                        await this.$router.push({name: 'VisualizarRegistroMovimentacaoInterna', params: {movimentacaoInternaId: id}})\n                    }\n                    else if (item.situacao === 'EM_ELABORACAO') {\n                        if (await this.verificarSeCamposObrigatoriosPreenchidos(item)) {\n                            if (await this.verificarSePossuiItensNaMovimentacao(id)) {\n                                this.redirecionaParaDocumentos(id)\n                            } else {\n                                this.redirecionaParaItens(id)\n                            }\n                        } else {\n                            this.redirecionaParaDadosGerais(id)\n                        }\n                    }\n                }\n            },\n            async verificarSeCamposObrigatoriosPreenchidos(item) {\n                if(item.tipo === 'DISTRIBUICAO'){\n                    return await this.getDistribuicaoValidado(item, this.nomeTelaDadosGerais, this.nomeTelaIncorporacao)\n                }\n                return false\n            },\n            async verificarSePossuiItensNaMovimentacao(id) {\n                const resultado = await this.buscarQuantidadeItensAdicionadosMovimentacaoInterna(id)\n                return resultado ? (resultado.quantidadeItens > 0) : false\n            },\n            redirecionaParaDocumentos(id) {\n                this.$router.push({name: 'MovimentacaoInternaEdicaoDocumentos', params: {movimentacaoInternaId: id}})\n            },\n            redirecionaParaItens(id) {\n                this.$router.push({name: 'MovimentacaoInternaEdicaoItens', params: {movimentacaoInternaId: id}})\n            },\n            redirecionaParaDadosGerais(id) {\n                this.$router.push({name: 'MovimentacaoInternaEdicaoDadosGerais', params: {movimentacaoInternaId: id}})\n            },\n            async buscarMovimentacoes(){\n                const retorno = await this.buscarTodasMovimentacoes(this.$route.params.patrimonioId)\n                if (!this.incorporacao.isEmpty) {\n                    retorno.items.push(this.incorporacao)\n                }\n                if(retorno && retorno.items.length > 0){\n                    this.verificaQuantidadeMovimentacoes(retorno.items)\n                }\n            },\n            verificaQuantidadeMovimentacoes(movimentacoes){\n                this.todasMovimentacoes = movimentacoes\n                this.cincoMovimentacoes = movimentacoes.slice(0, 5)\n                if(movimentacoes.length > 5){\n                    this.movimentacoes = this.cincoMovimentacoes\n                }else{\n                    this.movimentacoes = this.todasMovimentacoes\n                }\n            },\n            tratarEventoVerMais(){\n                this.movimentacoes = this.todasMovimentacoes\n            },\n            tratarEventoVerMenos(){\n                this.movimentacoes = this.cincoMovimentacoes\n            },\n            retornaIcone(item){\n                return this.situacoesSemAlteracao.includes(item.situacao) ? 'done' : 'priority_high'\n            },\n            retornaCor(item){\n                return this.situacoesSemAlteracao.includes(item.situacao) ? 'primary' : 'orange'\n            },\n            movimentacaoIncorporacao(item){\n                return item.tipo === 'INCORPORACAO'\n            },\n            movimentacaoEmElaboracao(item) {\n                return item.situacao === 'EM_ELABORACAO'\n            },\n            retornaData(item){\n                return item.situacao === 'FINALIZADO' ||  item.situacao === 'DEVOLVIDO' ? item.dataFinalizacao : item.dataCriacao\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n.corpo-conteiner\n    min-height 75vh\n\n.alinhamentoTimeline\n    margin-left auto\n    margin-right auto\n    padding-top 100px !important\n</style>\n"],"sourceRoot":"src/views/pages/patrimonios/patrimonio/ficha-patrimonios/movimentacoes"}]}