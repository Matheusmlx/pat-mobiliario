{"remainingRequest":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/babel-loader/lib/index.js!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/eslint-loader/index.js??ref--13-0!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/application/listeners/InterceptadorHttp.js","dependencies":[{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/application/listeners/InterceptadorHttp.js","mtime":1617276950866},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/@babel/runtime/regenerator\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nimport axios from 'axios';\nimport store from '@/core/store';\nimport { LoadingScreen } from '@/core/utils';\nimport ApiErrorValidations from '@/core/exceptions/ApiErrorValidations';\nimport exceptionHandler from '@/core/exceptions/ExceptionHandler';\nimport { mutationTypes } from '../../core/constants';\nvar loading = new LoadingScreen(store);\n\nvar InterceptadorHttp = /*#__PURE__*/function () {\n  function InterceptadorHttp() {\n    _classCallCheck(this, InterceptadorHttp);\n  }\n\n  _createClass(InterceptadorHttp, [{\n    key: \"execute\",\n    value: function () {\n      var _execute = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                return _context.abrupt(\"return\", new Promise(function (resolve) {\n                  _this.registrarInterceptadores();\n\n                  _this.setarVariaveisFixasNoHeaderDaRequest();\n\n                  resolve();\n                }));\n\n              case 1:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      function execute() {\n        return _execute.apply(this, arguments);\n      }\n\n      return execute;\n    }()\n  }, {\n    key: \"registrarInterceptadores\",\n    value: function registrarInterceptadores() {\n      axios.interceptors.request.use(this.tratarRequest, this.tratarErros);\n      axios.interceptors.response.use(this.tratarResponse, this.tratarErros);\n    }\n  }, {\n    key: \"setarVariaveisFixasNoHeaderDaRequest\",\n    value: function setarVariaveisFixasNoHeaderDaRequest() {\n      axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest';\n    }\n  }, {\n    key: \"tratarRequest\",\n    value: function tratarRequest(config) {\n      loading.start();\n      return config;\n    }\n  }, {\n    key: \"tratarResponse\",\n    value: function tratarResponse(response) {\n      loading.stop();\n      return response;\n    }\n  }, {\n    key: \"tratarErros\",\n    value: function tratarErros(error) {\n      loading.stop();\n      var intercept = new InterceptadorHttp();\n\n      if (error.response.data && error.response.status !== 401) {\n        intercept.mostrarFalhaSalvamentoAutomaticoSeAtivo();\n        var apiErrorValidations = new ApiErrorValidations(error.response.data.message, error.response);\n        exceptionHandler.execute(apiErrorValidations);\n      } else {\n        exceptionHandler.handleUnauthorized();\n      }\n    }\n  }, {\n    key: \"mostrarFalhaSalvamentoAutomaticoSeAtivo\",\n    value: function mostrarFalhaSalvamentoAutomaticoSeAtivo() {\n      if (store.state.loki.autoSave.saving) {\n        store.commit(mutationTypes.COMUM.MOSTRAR_FALHA_SALVAMENTO_AUTOMATICO);\n      }\n    }\n  }]);\n\n  return InterceptadorHttp;\n}();\n\nexport default new InterceptadorHttp();",{"version":3,"sources":["/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/application/listeners/InterceptadorHttp.js"],"names":["axios","store","LoadingScreen","ApiErrorValidations","exceptionHandler","mutationTypes","loading","InterceptadorHttp","Promise","resolve","registrarInterceptadores","setarVariaveisFixasNoHeaderDaRequest","interceptors","request","use","tratarRequest","tratarErros","response","tratarResponse","defaults","headers","common","config","start","stop","error","intercept","data","status","mostrarFalhaSalvamentoAutomaticoSeAtivo","apiErrorValidations","message","execute","handleUnauthorized","state","loki","autoSave","saving","commit","COMUM","MOSTRAR_FALHA_SALVAMENTO_AUTOMATICO"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,cAAlB;AACA,SAASC,aAAT,QAA8B,cAA9B;AACA,OAAOC,mBAAP,MAAgC,uCAAhC;AACA,OAAOC,gBAAP,MAA6B,oCAA7B;AACA,SAAQC,aAAR,QAA4B,sBAA5B;AAGA,IAAMC,OAAO,GAAG,IAAIJ,aAAJ,CAAkBD,KAAlB,CAAhB;;IAEMM,iB;;;;;;;;;;;;;;;iDAES,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC5B,kBAAA,KAAI,CAACC,wBAAL;;AACA,kBAAA,KAAI,CAACC,oCAAL;;AACAF,kBAAAA,OAAO;AACV,iBAJM,C;;;;;;;;;;;;;;;;;;+CAOgB;AACvBT,MAAAA,KAAK,CAACY,YAAN,CAAmBC,OAAnB,CAA2BC,GAA3B,CAA+B,KAAKC,aAApC,EAAmD,KAAKC,WAAxD;AACAhB,MAAAA,KAAK,CAACY,YAAN,CAAmBK,QAAnB,CAA4BH,GAA5B,CAAgC,KAAKI,cAArC,EAAqD,KAAKF,WAA1D;AACH;;;2DAEsC;AACnChB,MAAAA,KAAK,CAACmB,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,kBAA9B,IAAoD,gBAApD;AACH;;;kCAEaC,M,EAAQ;AAClBhB,MAAAA,OAAO,CAACiB,KAAR;AACA,aAAOD,MAAP;AACH;;;mCAEcL,Q,EAAU;AACrBX,MAAAA,OAAO,CAACkB,IAAR;AACA,aAAOP,QAAP;AACH;;;gCAEWQ,K,EAAO;AACfnB,MAAAA,OAAO,CAACkB,IAAR;AACA,UAAME,SAAS,GAAG,IAAInB,iBAAJ,EAAlB;;AACA,UAAIkB,KAAK,CAACR,QAAN,CAAeU,IAAf,IAAuBF,KAAK,CAACR,QAAN,CAAeW,MAAf,KAA0B,GAArD,EAA0D;AACtDF,QAAAA,SAAS,CAACG,uCAAV;AACA,YAAMC,mBAAmB,GAAG,IAAI3B,mBAAJ,CAAwBsB,KAAK,CAACR,QAAN,CAAeU,IAAf,CAAoBI,OAA5C,EAAqDN,KAAK,CAACR,QAA3D,CAA5B;AACAb,QAAAA,gBAAgB,CAAC4B,OAAjB,CAAyBF,mBAAzB;AACH,OAJD,MAIO;AACH1B,QAAAA,gBAAgB,CAAC6B,kBAAjB;AACH;AACJ;;;8DAEyC;AACtC,UAAGhC,KAAK,CAACiC,KAAN,CAAYC,IAAZ,CAAiBC,QAAjB,CAA0BC,MAA7B,EAAoC;AAChCpC,QAAAA,KAAK,CAACqC,MAAN,CAAajC,aAAa,CAACkC,KAAd,CAAoBC,mCAAjC;AACH;AACJ;;;;;;AAIL,eAAe,IAAIjC,iBAAJ,EAAf","sourcesContent":["import axios from 'axios'\nimport store from '@/core/store'\nimport { LoadingScreen } from '@/core/utils'\nimport ApiErrorValidations from '@/core/exceptions/ApiErrorValidations'\nimport exceptionHandler from '@/core/exceptions/ExceptionHandler'\nimport {mutationTypes} from '../../core/constants'\n\n\nconst loading = new LoadingScreen(store)\n\nclass InterceptadorHttp {\n    async execute() {\n        return new Promise((resolve) => {\n            this.registrarInterceptadores()\n            this.setarVariaveisFixasNoHeaderDaRequest()\n            resolve()\n        })\n    }\n\n    registrarInterceptadores() {\n        axios.interceptors.request.use(this.tratarRequest, this.tratarErros)\n        axios.interceptors.response.use(this.tratarResponse, this.tratarErros)\n    }\n\n    setarVariaveisFixasNoHeaderDaRequest() {\n        axios.defaults.headers.common['X-Requested-With'] = 'XMLHttpRequest'\n    }\n\n    tratarRequest(config) {\n        loading.start()\n        return config\n    }\n\n    tratarResponse(response) {\n        loading.stop()\n        return response\n    }\n\n    tratarErros(error) {\n        loading.stop()\n        const intercept = new InterceptadorHttp()\n        if (error.response.data && error.response.status !== 401) {\n            intercept.mostrarFalhaSalvamentoAutomaticoSeAtivo()\n            const apiErrorValidations = new ApiErrorValidations(error.response.data.message, error.response)\n            exceptionHandler.execute(apiErrorValidations)\n        } else {\n            exceptionHandler.handleUnauthorized()\n        }\n    }\n\n    mostrarFalhaSalvamentoAutomaticoSeAtivo() {\n        if(store.state.loki.autoSave.saving){\n            store.commit(mutationTypes.COMUM.MOSTRAR_FALHA_SALVAMENTO_AUTOMATICO)\n        }\n    }\n\n}\n\nexport default new InterceptadorHttp()\n"]}]}