{"remainingRequest":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/babel-loader/lib/index.js!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/patrimonios/incorporacao/edicao/documentos/ListagemDocumentosItem.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/patrimonios/incorporacao/edicao/documentos/ListagemDocumentosItem.vue","mtime":1616512748425},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _regeneratorRuntime from \"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport AzHasPermissions from '@azinformatica/loki/src/utils/AzHasPermissions';\nimport { createNamespacedHelpers } from 'vuex';\nimport BotaoRemover from '@/views/components/botoes/BotaoRemover';\nimport LabelPersonalizado from '@/views/components/label/LabelPersonalizado';\n\nvar _createNamespacedHelp = createNamespacedHelpers('rotulosPersonalizados'),\n    mapGetters = _createNamespacedHelp.mapGetters;\n\nexport default {\n  components: {\n    BotaoRemover: BotaoRemover,\n    LabelPersonalizado: LabelPersonalizado\n  },\n  props: {\n    value: {\n      default: function _default() {\n        return {};\n      }\n    },\n    tipoDocumento: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    index: {\n      type: Number\n    }\n  },\n  $_veeValidate: {\n    validator: 'new'\n  },\n  data: function data() {\n    return {\n      EhUsuarioNormal: true,\n      errorObrigatoriedadeAnexo: 0,\n      errorTamanhoExcedido: 0,\n      validateRequeridAzMoney: 0,\n      regrasAnexo: '',\n      nomeAnexo: '',\n      deletarBotao: 'grey',\n      apagar: true,\n      todosCamposObrigatorios: false,\n      incorporacaoId: null,\n      nomeTela: 'DOCUMENTOS'\n    };\n  },\n  mounted: function () {\n    var _mounted = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              this.setIncorporacaoId();\n              this.tratarPerfilEhUsuarioNormal();\n              this.tratarCampoAnexo();\n              _context.next = 5;\n              return this.verificarCamposObrigatorios();\n\n            case 5:\n              if (!this.verificaPermissaoEdicao) {\n                this.documentosIncorporacaoVisualizacao();\n              }\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }(),\n  watch: {\n    'value.uriAnexo': function () {\n      var _valueUriAnexo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.tratarCampoAnexo();\n\n                if (!(typeof this.value.uriAnexo == 'string')) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                _context2.next = 4;\n                return this.tratarEventoEdicaoCampo();\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function valueUriAnexo() {\n        return _valueUriAnexo.apply(this, arguments);\n      }\n\n      return valueUriAnexo;\n    }()\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters(['getObrigatorioRotulosPersonalizados', 'getDocumentoTodosObrigatoriosValidado', 'getDocumentoNumeroTipoObrigatorioValidado'])), {}, {\n    verificaPermissaoEdicao: function verificaPermissaoEdicao() {\n      return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Normal']);\n    }\n  }),\n  methods: {\n    tratarPerfilEhUsuarioNormal: function tratarPerfilEhUsuarioNormal() {\n      this.EhUsuarioNormal = AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Normal']);\n    },\n    tratarCampoAnexo: function tratarCampoAnexo() {\n      if (typeof this.value.uriAnexo == 'string') {\n        this.nomeAnexo = this.value.uriAnexo.split('/')[1];\n      }\n    },\n    anularCampoAnexo: function anularCampoAnexo() {\n      if (this.verificaPermissaoEdicao) {\n        this.value.uriAnexo = null;\n        this.errorObrigatoriedadeAnexo = 0;\n        this.errorTamanhoExcedido = 0;\n      }\n    },\n    verificarCamposObrigatorios: function () {\n      var _verificarCamposObrigatorios = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var _this = this;\n\n        var documentoEncontrado;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                documentoEncontrado = this.tipoDocumento.find(function (element) {\n                  return element.id === _this.value.tipo;\n                });\n\n                if (!(documentoEncontrado && (documentoEncontrado.descricao === 'Nota Fiscal' || documentoEncontrado.descricao === 'Nota de Empenho'))) {\n                  _context3.next = 9;\n                  break;\n                }\n\n                this.todosCamposObrigatorios = true;\n                this.validateRequeridAzMoney++;\n                _context3.next = 6;\n                return this.$validator._base.validateAll();\n\n              case 6:\n                return _context3.abrupt(\"return\", true);\n\n              case 9:\n                this.todosCamposObrigatorios = false;\n                return _context3.abrupt(\"return\", true);\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function verificarCamposObrigatorios() {\n        return _verificarCamposObrigatorios.apply(this, arguments);\n      }\n\n      return verificarCamposObrigatorios;\n    }(),\n    tratarEventoEdicaoCampo: function () {\n      var _tratarEventoEdicaoCampo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var verificarCamposObrigatorios;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (this.todosCamposObrigatorios || this.getObrigatorioRotulosPersonalizados('valor', this.nomeTela)) {\n                  this.validateRequeridAzMoney++;\n                }\n\n                if (this.errors.collect('uriAnexo')) {\n                  this.errorObrigatoriedadeAnexo = 1;\n                }\n\n                _context4.next = 4;\n                return this.verificarCamposObrigatorios();\n\n              case 4:\n                verificarCamposObrigatorios = _context4.sent;\n\n                if (!(verificarCamposObrigatorios && this.verificaPermissaoEdicao)) {\n                  _context4.next = 10;\n                  break;\n                }\n\n                this.retiraEspacosVazios();\n                _context4.next = 9;\n                return this.$validator._base.validateAll();\n\n              case 9:\n                if (this.todosCamposObrigatorios) {\n                  if (this.getDocumentoTodosObrigatoriosValidado(this.value, this.nomeTela)) {\n                    this.$emit('salvar', this.value);\n                  }\n                } else {\n                  if (this.getDocumentoNumeroTipoObrigatorioValidado(this.value, this.nomeTela)) {\n                    this.$emit('salvar', this.value);\n                  }\n                }\n\n              case 10:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function tratarEventoEdicaoCampo() {\n        return _tratarEventoEdicaoCampo.apply(this, arguments);\n      }\n\n      return tratarEventoEdicaoCampo;\n    }(),\n    retiraEspacosVazios: function retiraEspacosVazios() {\n      if (this.value.numero) {\n        this.value.numero = this.value.numero.trim();\n      }\n    },\n    baixarAnexo: function baixarAnexo() {\n      this.$emit('baixarAnexo', this.value.uriAnexo);\n    },\n    tratarEventoSalvarAnexo: function () {\n      var _tratarEventoSalvarAnexo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n        var _this2 = this;\n\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (!(this.value && this.value.uriAnexo)) {\n                  _context5.next = 16;\n                  break;\n                }\n\n                if (!(this.extensaoArquivoValida(this.value.uriAnexo) === -1)) {\n                  _context5.next = 6;\n                  break;\n                }\n\n                this.mostrarNotificacaoErro('Extensão do arquivo inválida. Envie arquivos nos seguintes formatos .pdf .jpg .png');\n                this.value.uriAnexo = null;\n                _context5.next = 16;\n                break;\n\n              case 6:\n                if (!this.validarTamanhoMaximo(this.value.uriAnexo.size)) {\n                  _context5.next = 14;\n                  break;\n                }\n\n                this.errorTamanhoExcedido = 1;\n                _context5.next = 10;\n                return null;\n\n              case 10:\n                this.value.uriAnexo = _context5.sent;\n                setTimeout(function () {\n                  _this2.errorTamanhoExcedido = 0;\n                  _this2.errorObrigatoriedadeAnexo = 1;\n\n                  _this2.$validator._base.validateAll();\n                }, 3000);\n                _context5.next = 16;\n                break;\n\n              case 14:\n                _context5.next = 16;\n                return this.$emit('salvarAnexo');\n\n              case 16:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function tratarEventoSalvarAnexo() {\n        return _tratarEventoSalvarAnexo.apply(this, arguments);\n      }\n\n      return tratarEventoSalvarAnexo;\n    }(),\n    extensaoArquivoValida: function extensaoArquivoValida(nomeArquivo) {\n      var extensaoAceitas = ['.pdf', '.PDF', '.jpg', '.JPG', '.png', '.PNG', '.jpeg', '.JPEG'];\n      var extensao = nomeArquivo.name.substr(nomeArquivo.name.lastIndexOf('.'), nomeArquivo.name.length);\n      return extensaoAceitas.indexOf(extensao);\n    },\n    validarTamanhoMaximo: function validarTamanhoMaximo(tamanhoAnexo) {\n      return tamanhoAnexo >= 15116247;\n    },\n    removerDocumento: function removerDocumento(documento) {\n      this.$emit('removerDocumento', documento);\n    },\n    setIncorporacaoId: function setIncorporacaoId() {\n      this.incorporacaoId = this.$route.params.incorporacaoId;\n    },\n    documentosIncorporacaoVisualizacao: function documentosIncorporacaoVisualizacao() {\n      this.$router.replace({\n        name: 'VisualizarIncorporacaoDocumentos',\n        params: {\n          incorporacaoId: this.incorporacaoId\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["ListagemDocumentosItem.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <v-row>\n        <v-col cols=\"9\" lg=\"11\" xs=\"12\">\n            <v-card class=\"elevation-0 documento\">\n                <v-container fluid>\n                    <v-form enctype=\"multipart/form-data\" class=\"az-form-content pb-0\" lazy-validation ref=\"form\">\n                        <v-row class=\"ma-0\">\n                            <v-col cols=\"12\" lg=\"2\" sm=\"12\" xs=\"12\" md=\"2\" :class=\"{ active: !verificaPermissaoEdicao}\">\n                                <v-text-field\n                                    v-model=\"value.numero\"\n                                    name=\"numero\"\n                                    maxlength=\"50\"\n                                    v-validate=\"'required'\"\n                                    :error-messages=\"errors.collect('numero')\"\n                                    :counter=\"50\"\n                                    :disabled=\"!verificaPermissaoEdicao\"\n                                    placeholder=\"Informe o número\"\n                                    @blur=\"tratarEventoEdicaoCampo\">\n                                    <template v-slot:label>\n                                        <label-personalizado campo=\"numero\" :tela=\"nomeTela\" obrigatorioPorPadrao/>\n                                    </template>\n                                </v-text-field>\n                            </v-col>\n                            <v-col cols=\"12\" lg=\"2\" sm=\"12\" xs=\"12\" md=\"2\" :class=\"{ active: !verificaPermissaoEdicao}\">\n                                <az-date\n                                    v-model=\"value.data\"\n                                    date\n                                    :is-disabled=\"!verificaPermissaoEdicao\"\n                                    v-mask=\"'##/##/####'\"\n                                    name-date=\"data\"\n                                    @input=\"tratarEventoEdicaoCampo\"\n                                    :is-required=\"todosCamposObrigatorios || getObrigatorioRotulosPersonalizados('data', nomeTela)\">\n                                    <template v-slot:label-date>\n                                        <label-personalizado campo=\"data\" :tela=\"nomeTela\"\n                                                             :permissaoEdicao=\"todosCamposObrigatorios || getObrigatorioRotulosPersonalizados('data', nomeTela)\"\n                                                             :obrigatorioPorPadrao=\"todosCamposObrigatorios\"/>\n                                    </template>\n                                </az-date>\n                            </v-col>\n                            <v-col cols=\"12\" lg=\"2\" sm=\"12\" xs=\"12\" md=\"2\" @focusout=\"tratarEventoEdicaoCampo\" :class=\"{ active: !verificaPermissaoEdicao}\">\n                                <az-money\n                                    v-model=\"value.valor\"\n                                    :required=\"todosCamposObrigatorios || getObrigatorioRotulosPersonalizados('valor', nomeTela)\"\n                                    requeridMessage=\"O campo é obrigatório\"\n                                    :disabled=\"!verificaPermissaoEdicao\"\n                                    :validation-field=\"validateRequeridAzMoney\"\n                                    :maxLength=\"18\"\n                                    :name=\"'valor'+index\"\n                                    placeholder=\"Informe o valor\">\n                                    <template v-slot:label>\n                                        <label-personalizado campo=\"valor\" :tela=\"nomeTela\"\n                                                             :permissaoEdicao=\"todosCamposObrigatorios || getObrigatorioRotulosPersonalizados('valor', nomeTela)\"\n                                                             :obrigatorioPorPadrao=\"todosCamposObrigatorios\"/>\n                                    </template>\n                                </az-money>\n                            </v-col>\n                            <v-col cols=\"12\" lg=\"3\" sm=\"12\" xs=\"12\" md=\"2\" :class=\"{ active: !verificaPermissaoEdicao}\">\n                                <v-autocomplete\n                                    v-model=\"value.tipo\"\n                                    :items=\"tipoDocumento\"\n                                    item-text=\"descricao\"\n                                    item-value=\"id\"\n                                    name=\"tipo\"\n                                    no-data-text=\"Não há tipos com esse nome\"\n                                    placeholder=\"Selecione\"\n                                    :error-messages=\"errors.collect('tipo')\"\n                                    :disabled=\"!verificaPermissaoEdicao\"\n                                    v-validate=\"'required'\"\n                                    @keydown.enter=\"tratarEventoEdicaoCampo\"\n                                    @blur=\"tratarEventoEdicaoCampo\"\n                                    @input=\"tratarEventoEdicaoCampo\">\n                                    <template v-slot:label>\n                                        <label-personalizado campo=\"tipo\" :tela=\"nomeTela\" obrigatorioPorPadrao/>\n                                    </template>\n                                </v-autocomplete>\n                            </v-col>\n                            <v-col cols=\"12\" lg=\"3\" sm=\"12\" xs=\"12\" md=\"4\" :class=\"{ active: !verificaPermissaoEdicao}\">\n                                <v-file-input\n                                    class=\"mt-3\"\n                                    v-model=\"value.uriAnexo\"\n                                    v-show=\"!value.uriAnexo\"\n                                    name=\"uriAnexo\"\n                                    :error-messages=\"errorTamanhoExcedido === 1 ? 'Tamanho permitido: 15MB' : errors.collect('uriAnexo')\"\n                                    file\n                                    dense\n                                    outlined\n                                    append-icon=\"fa-file-upload\"\n                                    v-validate=\"getObrigatorioRotulosPersonalizados('uriAnexo', this.nomeTela) ? 'required' : ''\"\n                                    prepend-icon\n                                    accept=\"image/png, image/jpeg, image/jpg, application/pdf\"\n                                    placeholder=\"Selecione o Arquivo\"\n                                    @change=\"tratarEventoSalvarAnexo\">\n                                    <template v-slot:label>\n                                        <label-personalizado campo=\"uriAnexo\" :tela=\"nomeTela\"/>\n                                    </template>\n                                </v-file-input>\n                                <p class=\"tamanhoPermitidoClass\"\n                                   v-if=\" !value.uriAnexo && errorTamanhoExcedido!==1 && errorObrigatoriedadeAnexo!==1\">\n                                    Tamanho permitido: 15MB</p>\n                                <v-text-field\n                                    outlined\n                                    readonly\n                                    v-if=\"value.uriAnexo\"\n                                    :value=\"nomeAnexo\">\n                                    <template v-slot:label>\n                                        <label-personalizado campo=\"uriAnexo\" :tela=\"nomeTela\"/>\n                                    </template>\n                                    <template v-slot:append>\n                                        <v-tooltip top>\n                                            <template v-slot:activator=\"{ on }\">\n                                                <a\n                                                    v-on=\"on\"\n                                                    slot=\"activator\"\n                                                    v-on:click=\"anularCampoAnexo\"\n                                                    target=\"_blank\"\n                                                    class=\"az-action-link-icon mt-1\"\n                                                >\n                                                    <i v-if=\"EhUsuarioNormal\" class=\"fas fa-times-circle\"></i>\n                                                </a>\n                                            </template>\n                                            Remover\n                                        </v-tooltip>\n                                    </template>\n                                    <template v-slot:append-outer>\n                                        <v-tooltip v-if=\"value.id\" top>\n                                            <template v-slot:activator=\"{ on }\">\n                                                <a\n                                                    v-on=\"on\"\n                                                    slot=\"activator\"\n                                                    :href=\"criarLinkDownload(value.uriAnexo)\"\n                                                    target=\"_blank\"\n                                                    class=\"az-action-link-icon mt-1\"\n                                                >\n                                                    <i class=\"fas fa-download\"></i>\n                                                </a>\n                                            </template>\n                                            Download\n                                        </v-tooltip>\n                                    </template>\n                                </v-text-field>\n                            </v-col>\n                        </v-row>\n                    </v-form>\n                </v-container>\n            </v-card>\n        </v-col>\n        <v-col align=\"center\" class=\"mt-12\" lg=\"1\" md=\"1\" ml-1 pl-5 sm=\"1\" xs=\"12\">\n            <botao-remover\n                :color=\"deletarBotao\"\n                icon=\"fas fa-minus-circle\"\n                size=\"22\"\n                @remover=\"removerDocumento(value)\"/>\n        </v-col>\n    </v-row>\n</template>\n\n<script>\n    import AzHasPermissions from '@azinformatica/loki/src/utils/AzHasPermissions'\n    import {createNamespacedHelpers} from 'vuex'\n    import BotaoRemover from '@/views/components/botoes/BotaoRemover'\n    import LabelPersonalizado from '@/views/components/label/LabelPersonalizado'\n\n    const {mapGetters} = createNamespacedHelpers('rotulosPersonalizados')\n\n    export default {\n        components: {BotaoRemover, LabelPersonalizado},\n        props: {\n            value: {\n                default: () => {\n                    return {}\n                },\n            },\n            tipoDocumento: {\n                type: Array,\n                default: () => {\n                    return []\n                },\n            },\n            index: {\n                type: Number,\n            },\n        },\n        $_veeValidate: {\n            validator: 'new',\n        },\n        data() {\n            return {\n                EhUsuarioNormal: true,\n                errorObrigatoriedadeAnexo: 0,\n                errorTamanhoExcedido: 0,\n                validateRequeridAzMoney: 0,\n                regrasAnexo: '',\n                nomeAnexo: '',\n                deletarBotao: 'grey',\n                apagar: true,\n                todosCamposObrigatorios: false,\n                incorporacaoId: null,\n                nomeTela: 'DOCUMENTOS'\n            }\n        },\n        async mounted() {\n            this.setIncorporacaoId()\n            this.tratarPerfilEhUsuarioNormal()\n            this.tratarCampoAnexo()\n            await this.verificarCamposObrigatorios()\n            if (!this.verificaPermissaoEdicao) {\n                this.documentosIncorporacaoVisualizacao()\n            }\n        },\n        watch: {\n            async 'value.uriAnexo'() {\n                this.tratarCampoAnexo()\n                if (typeof this.value.uriAnexo == 'string') {\n                    await this.tratarEventoEdicaoCampo()\n                }\n            },\n        },\n        computed: {\n            ...mapGetters([\n                'getObrigatorioRotulosPersonalizados',\n                'getDocumentoTodosObrigatoriosValidado',\n                'getDocumentoNumeroTipoObrigatorioValidado'\n            ]),\n            verificaPermissaoEdicao() {\n                return AzHasPermissions(this.$store.state.loki.user.authorities, [\n                    'Mobiliario.Normal',\n                ])\n            },\n        },\n        methods: {\n            tratarPerfilEhUsuarioNormal() {\n                this.EhUsuarioNormal = AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Normal'])\n            },\n            tratarCampoAnexo() {\n                if (typeof this.value.uriAnexo == 'string') {\n                    this.nomeAnexo = this.value.uriAnexo.split('/')[1]\n                }\n            },\n            anularCampoAnexo() {\n                if (this.verificaPermissaoEdicao) {\n                    this.value.uriAnexo = null\n                    this.errorObrigatoriedadeAnexo = 0\n                    this.errorTamanhoExcedido = 0\n                }\n            },\n            async verificarCamposObrigatorios() {\n                const documentoEncontrado = this.tipoDocumento.find(\n                    element => element.id === this.value.tipo\n                )\n                if (documentoEncontrado &&\n                    (documentoEncontrado.descricao === 'Nota Fiscal' || documentoEncontrado.descricao === 'Nota de Empenho')) {\n                    this.todosCamposObrigatorios = true\n                    this.validateRequeridAzMoney++\n                    await this.$validator._base.validateAll()\n                    return true\n                } else {\n                    this.todosCamposObrigatorios = false\n                    return true\n                }\n            },\n            async tratarEventoEdicaoCampo() {\n                if (\n                    this.todosCamposObrigatorios ||\n                    this.getObrigatorioRotulosPersonalizados('valor', this.nomeTela)\n                ) {\n                    this.validateRequeridAzMoney++\n                }\n                if (this.errors.collect('uriAnexo')) {\n                    this.errorObrigatoriedadeAnexo = 1\n                }\n                const verificarCamposObrigatorios = await this.verificarCamposObrigatorios()\n                if (verificarCamposObrigatorios && this.verificaPermissaoEdicao) {\n                    this.retiraEspacosVazios()\n                    await this.$validator._base.validateAll()\n\n                    if(this.todosCamposObrigatorios) {\n                        if (this.getDocumentoTodosObrigatoriosValidado(this.value,this.nomeTela)) {\n                            this.$emit('salvar', this.value)\n                        }\n                    }else{\n                        if (this.getDocumentoNumeroTipoObrigatorioValidado(this.value,this.nomeTela)) {\n                            this.$emit('salvar', this.value)\n                        }\n                    }\n                }\n            },\n            retiraEspacosVazios() {\n                if (this.value.numero) {\n                    this.value.numero = this.value.numero.trim()\n                }\n            },\n            baixarAnexo() {\n                this.$emit('baixarAnexo', this.value.uriAnexo)\n            },\n            async tratarEventoSalvarAnexo() {\n                if(this.value && this.value.uriAnexo) {\n                    if (this.extensaoArquivoValida(this.value.uriAnexo) === -1) {\n                        this.mostrarNotificacaoErro(\n                            'Extensão do arquivo inválida. Envie arquivos nos seguintes formatos .pdf .jpg .png'\n                        )\n                        this.value.uriAnexo = null\n                    } else {\n                        if (this.validarTamanhoMaximo(this.value.uriAnexo.size)) {\n                            this.errorTamanhoExcedido = 1\n                            this.value.uriAnexo = await null\n                            setTimeout(() => {\n                                this.errorTamanhoExcedido = 0\n                                this.errorObrigatoriedadeAnexo = 1\n                                this.$validator._base.validateAll()\n                            }, 3000)\n                        } else {\n                            await this.$emit('salvarAnexo')\n                        }\n                    }\n                }\n            },\n            extensaoArquivoValida(nomeArquivo) {\n                const extensaoAceitas = [\n                    '.pdf',\n                    '.PDF',\n                    '.jpg',\n                    '.JPG',\n                    '.png',\n                    '.PNG',\n                    '.jpeg',\n                    '.JPEG',\n                ]\n                const extensao = nomeArquivo.name.substr(\n                    nomeArquivo.name.lastIndexOf('.'),\n                    nomeArquivo.name.length\n                )\n                return extensaoAceitas.indexOf(extensao)\n            },\n            validarTamanhoMaximo(tamanhoAnexo) {\n                return (tamanhoAnexo >= 15116247)\n            },\n            removerDocumento(documento) {\n                this.$emit('removerDocumento', documento)\n            },\n            setIncorporacaoId() {\n                this.incorporacaoId = this.$route.params.incorporacaoId\n            },\n            documentosIncorporacaoVisualizacao() {\n                this.$router.replace({\n                    name: 'VisualizarIncorporacaoDocumentos',\n                    params: {\n                        incorporacaoId: this.incorporacaoId\n                    }\n                })\n            }\n        },\n    }\n</script>\n\n<style lang=\"stylus\" scoped>\n    .active\n        cursor not-allowed\n\n    .documento\n        border 1px solid #d9d9d9\n\n    .tamanhoPermitidoClass\n        color #a5a5a5\n        margin-top -10px\n        font-size 12px\n</style>\n"],"sourceRoot":"src/views/pages/patrimonios/incorporacao/edicao/documentos"}]}