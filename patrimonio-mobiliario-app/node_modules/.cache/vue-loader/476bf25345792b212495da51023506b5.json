{"remainingRequest":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/movimentacao/movimentacao-interna/edicao/dados-gerais/distribuicao/EdicaoDadosGeraisDistribuicao.vue?vue&type=style&index=0&id=16dc4fe6&scoped=true&lang=stylus&","dependencies":[{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/movimentacao/movimentacao-interna/edicao/dados-gerais/distribuicao/EdicaoDadosGeraisDistribuicao.vue","mtime":1615564333676},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.movimentacao-edicao-dados-gerais\n    min-height 62vh\n\n\n.label-motivo\n    font-size 14px\n    font-weight bold\n    color #555555\n    opacity 0.7\n\n",{"version":3,"sources":["EdicaoDadosGeraisDistribuicao.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqWA;AACA;;;AAGA;AACA;AACA;AACA;AACA","file":"EdicaoDadosGeraisDistribuicao.vue","sourceRoot":"src/views/pages/movimentacao/movimentacao-interna/edicao/dados-gerais/distribuicao","sourcesContent":["<template>\n    <div>\n        <v-form class=\"az-form-content pb-0\" ref=\"form\">\n            <v-container class=\"white movimentacao-edicao-dados-gerais\" fluid>\n                <v-row>\n                    <v-col cols=\"12\" md=\"4\" sm=\"6\" xs=\"12\">\n                        <auto-complete\n                            v-model=\"distribuicao.orgao\"\n                            item-text=\"descricao\"\n                            item-value=\"id\"\n                            no-data-text=\"Não há órgãos com este nome\"\n                            name=\"orgao\"\n                            :required=\"true\"\n                            :requiredIcon=\"verificaPermissaoEdicao\"\n                            :items=\"orgaosOrigem\"\n                            :disabled=\"!verificaPermissaoEdicao\"\n                            :placeholder=\"verificaPermissaoEdicao ? 'Selecione o órgão de origem' : ' '\"\n                            :filter=\"filtroComboAutoComplete\"\n                            campo=\"orgao\"\n                            :nomeTela=\"nomeTelaIncorporacao\"\n                            :obrigatorioPorPadrao=\"true\"\n                            label=\"Órgão Responsável\"\n                            @changeValue=\"alterarValor\"\n                            @change=\"tratarEventoMudancaOrgaoOrigem\">\n                        </auto-complete>\n                    </v-col>\n\n                    <v-col cols=\"12\" md=\"4\" sm=\"6\" xs=\"12\">\n                        <auto-complete\n                            v-model=\"distribuicao.setorOrigem\"\n                            item-text=\"descricao\"\n                            item-value=\"id\"\n                            no-data-text=\"Não há setores com este nome\"\n                            name=\"setorOrigem\"\n                            :required=\"distribuicao.orgao ? 'required' : ''\"\n                            :requiredIcon=\"distribuicao.orgao && verificaPermissaoEdicao\"\n                            :items=\"setoresOrigem\"\n                            :disabled=\"!distribuicao.orgao || !verificaPermissaoEdicao\"\n                            :placeholder=\"verificaPermissaoEdicao && distribuicao.orgao ? 'Selecione o setor de origem' : ' '\"\n                            label=\"Almoxarifado Origem\"\n                            @changeValue=\"alterarValor\"\n                            @change=\"editarDistribuicao\">\n                        </auto-complete>\n                    </v-col>\n\n                    <v-col cols=\"12\" md=\"4\" sm=\"6\" xs=\"12\">\n                        <auto-complete\n                            v-model=\"distribuicao.setorDestino\"\n                            item-text=\"descricao\"\n                            item-value=\"id\"\n                            no-data-text=\"Não há setores com este nome\"\n                            name=\"setorDestino\"\n                            :required=\"distribuicao.orgao ? 'required' : ''\"\n                            :items=\"setoresDestino\"\n                            :disabled=\"!distribuicao.orgao || !verificaPermissaoEdicao\"\n                            :placeholder=\"verificaPermissaoEdicao && distribuicao.orgao ? 'Selecione o setor de destino' : ' '\"\n                            :permissaoEdicao=\"!!(distribuicao.orgao) && verificaPermissaoEdicao\"\n                            campo=\"setorDestino\"\n                            :nomeTela=\"nomeTela\"\n                            :obrigatorioPorPadrao=\"true\"\n                            @changeValue=\"alterarValor\"\n                            @change=\"editarDistribuicao\">\n                        </auto-complete>\n                    </v-col>\n\n                    <v-col cols=\"12\" md=\"12\" sm=\"12\" xs=\"12\">\n                        <v-textarea\n                            v-model=\"distribuicao.motivoObservacao\"\n                            :counter=\"500\"\n                            :error-messages=\"errors.collect('motivoObservacao')\"\n                            auto-grow\n                            rows=\"1\"\n                            maxlength=\"500\"\n                            name=\"motivoObservacao\"\n                            v-validate=\"getObrigatorioRotulosPersonalizados('motivoObservacao', nomeTela)? 'required': ''\"\n                            placeholder=\"Digite o motivo\"\n                            class=\"mt-3\"\n                            @change=\"editarDistribuicao\">\n                            <template v-slot:label>\n                                <label-personalizado class=\"label-motivo\" campo=\"motivoObservacao\" :tela=\"nomeTela\"\n                                                     :permissaoEdicao=\"verificaPermissaoEdicao\"/>\n                            </template>\n                        </v-textarea>\n                    </v-col>\n\n                    <v-col cols=\"12\" md=\"4\" sm=\"6\" xs=\"12\">\n                        <v-text-field\n                            v-model=\"distribuicao.numeroNotaLancamentoContabil\"\n                            :disabled=\"!verificaPermissaoEdicao\"\n                            :class=\"{desativado: !verificaPermissaoEdicao}\"\n                            name=\"numeroNotaLancamentoContabil\"\n                            :placeholder=\"verificaPermissaoEdicao ? placeholders.numeroNotaLancamentoContabil : ' '\"\n                            maxlength=\"12\"\n                            v-mask=\"'####NL######'\"\n                            v-validate=\"getObrigatorioRotulosPersonalizados('numeroNotaLancamentoContabil', nomeTelaIncorporacao)?'required|max:12' : 'max:12'\"\n                            :error-messages=\"errors.collect('numeroNotaLancamentoContabil')\"\n                            @change=\"editarDistribuicao\">\n                            <template v-slot:label>\n                                <label-personalizado campo=\"numeroNotaLancamentoContabil\" :tela=\"nomeTelaIncorporacao\"\n                                                     :permissaoEdicao=\"verificaPermissaoEdicao\"/>\n                            </template>\n                        </v-text-field>\n                    </v-col>\n\n                    <v-col cols=\"12\" md=\"4\" sm=\"6\" xs=\"12\">\n                        <az-date\n                            v-model=\"distribuicao.dataNotaLancamentoContabil\"\n                            :is-disabled=\"!verificaPermissaoEdicao\"\n                            :class=\"{desativado: !verificaPermissaoEdicao}\"\n                            name-date=\"dataNotaLancamentoContabil\"\n                            date\n                            :is-required=\"getObrigatorioRotulosPersonalizados('dataNotaLancamentoContabil', nomeTelaIncorporacao)\"\n                            :max-date=\"moment(new Date()).format('YYYY-MM-DDTHH:mm:ssZZ')\"\n                            @input=\"editarDistribuicao\"\n                            :placeholderDate=\"(distribuicao.dataNotaLancamentoContabil) ? ' ' : placeholders.date\"\n                            :error-messages=\"errors.collect('dataNotaLancamentoContabil')\">\n                            <template v-slot:label-date>\n                                <label-personalizado campo=\"dataNotaLancamentoContabil\" :tela=\"nomeTelaIncorporacao\"\n                                                     :permissaoEdicao=\"verificaPermissaoEdicao\"/>\n                            </template>\n                        </az-date>\n                    </v-col>\n\n                    <v-col cols=\"12\" md=\"4\" sm=\"6\" xs=\"12\">\n                        <v-text-field\n                            v-model=\"distribuicao.numeroProcesso\"\n                            :disabled=\"!verificaPermissaoEdicao\"\n                            :class=\"{desativado: !verificaPermissaoEdicao}\"\n                            name=\"numeroProcesso\"\n                            :placeholder=\"verificaPermissaoEdicao ? 'Informe o número' : ' '\"\n                            maxlength=\"100\"\n                            :counter=\"100\"\n                            v-validate=\"getObrigatorioRotulosPersonalizados('numeroProcesso', nomeTela)?'required|max:100' : 'max:100'\"\n                            :error-messages=\"errors.collect('numeroProcesso')\"\n                            @change=\"editarDistribuicao\">\n                            <template v-slot:label>\n                                <label-personalizado campo=\"numeroProcesso\" :tela=\"nomeTela\"\n                                                     :permissaoEdicao=\"verificaPermissaoEdicao\"/>\n                            </template>\n                        </v-text-field>\n                    </v-col>\n\n                    <v-col cols=\"12\" md=\"4\" sm=\"6\" xs=\"12\">\n                        <v-autocomplete\n                            v-model=\"distribuicao.responsavel\"\n                            :disabled=\"!verificaPermissaoEdicao\"\n                            :items=\"responsaveis\"\n                            item-text=\"nome\"\n                            item-value=\"id\"\n                            no-data-text=\"Não há responśaveis com esse nome\"\n                            name=\"responsavel\"\n                            :class=\"{desativado: !verificaPermissaoEdicao}\"\n                            v-validate=\"getObrigatorioRotulosPersonalizados('responsavel', nomeTelaDistribuicao)? 'required': ''\"\n                            :error-messages=\"errors.collect('responsavel')\"\n                            placeholder=\"Selecione o responsável\"\n                            @change=\"editarDistribuicao\">\n                            <template v-slot:label>\n                                <label-personalizado campo=\"responsavel\" :tela=\"nomeTelaDistribuicao\"\n                                                     :permissaoEdicao=\"verificaPermissaoEdicao\"/>\n                            </template>\n                        </v-autocomplete>\n                    </v-col>\n                </v-row>\n            </v-container>\n        </v-form>\n        <acoes-botoes-continuar-voltar :controleContinuar=\"podeContinuar\" @voltar=\"voltar\" @continuar=\"continuar\"/>\n    </div>\n</template>\n\n<script>\n    import {actionTypes, mutationTypes} from '@/core/constants'\n    import {createNamespacedHelpers, mapActions} from 'vuex'\n    import AzHasPermissions from '@azinformatica/loki/src/utils/AzHasPermissions'\n    import LabelPersonalizado from '@/views/components/label/LabelPersonalizado'\n    import AcoesBotoesContinuarVoltar from '@/views/components/acoes/AcoesBotoesContinuarVoltar'\n    import AutoComplete from '@/views/components/autocomplete/AutoComplete'\n\n    const {mapGetters} = createNamespacedHelpers('rotulosPersonalizados')\n\n    export default {\n        name: 'EdicaoDadosGeraisDistribuicao',\n        components: {AutoComplete, AcoesBotoesContinuarVoltar, LabelPersonalizado},\n        data() {\n            return {\n                distribuicao: {\n                    responsavel: null\n                },\n                dadosDeEntrada: {},\n                responsaveis: [],\n                orgaosOrigem: [],\n                setoresOrigem: [],\n                setoresDestino: [],\n                placeholders: {\n                    date: '__/__/____',\n                    numeroNotaLancamentoContabil: '____NL_____'\n                },\n                nomeTela: 'MOVIMENTACAO_INTERNA_DADOS_GERAIS',\n                nomeTelaIncorporacao: 'INCORPORACAO_DADOS_GERAIS',\n                nomeTelaDistribuicao: 'DISTRIBUICAO_DADOS_GERAIS'\n            }\n        },\n        async mounted() {\n            await this.buscarDistribuicao()\n            await this.buscarOrgaosOrigem()\n            await this.buscarResponsaveis()\n        },\n        computed: {\n            ...mapGetters([\n                'getObrigatorioRotulosPersonalizados',\n                'getDistribuicaoValidado'\n            ]),\n            verificaPermissaoEdicao() {\n                return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Movimentacoes'])\n            },\n            podeContinuar(){\n                if(this.getDistribuicaoValidado(this.distribuicao,this.nomeTela,this.nomeTelaIncorporacao, this.nomeTelaDistribuicao)){\n                    this.habilitaPasso3()\n                    return true\n                }else{\n                    this.desabilitaPasso3()\n                    return false\n                }\n            }\n        },\n        methods: {\n            ...mapActions({\n                buscarTodosOrgaosOrigem: actionTypes.COMUM.BUSCAR_TODOS_ORGAOS,\n                buscarTodosResponsaveis: actionTypes.RESPONSAVEL.BUSCAR_TODOS_RESPONSAVEIS\n            }),\n            ...mapActions([\n                actionTypes.COMUM.BUSCAR_SETORES_ALMOXARIFADO,\n                actionTypes.COMUM.BUSCAR_SETORES_NAO_ALMOXARIFADO,\n                actionTypes.MOVIMENTACAO_INTERNA.DISTRIBUICAO.ATUALIZAR_DISTRIBUICAO,\n                actionTypes.MOVIMENTACAO_INTERNA.DISTRIBUICAO.BUSCAR_DISTRIBUICAO_POR_ID\n            ]),\n            habilitaPasso3(){\n                this.$emit('habilitaPasso3')\n            },\n            desabilitaPasso3(){\n                this.$emit('desabilitaPasso3')\n            },\n            voltar() {\n                this.$router.replace({name: 'MovimentacaoInternaEdicaoTipo'})\n            },\n            continuar() {\n                this.$router.replace({\n                    name: 'MovimentacaoInternaEdicaoItens',\n                    params: {movimentacaoInternaId: this.$route.params.movimentacaoInternaId}\n                })\n            },\n            filtroComboAutoComplete(item, queryText) {\n                if(item && item.nome && item.sigla){\n                    const text = item.nome.toLowerCase()\n                    const textSigla = item.sigla.toLowerCase()\n                    const searchText = queryText.toLowerCase()\n                    return (text.indexOf(searchText) > -1 || textSigla.indexOf(searchText) > -1)\n                }\n                return false\n            },\n            async buscarOrgaosOrigem() {\n                this.desabilitarLoadingGlobal()\n                const resultado = await this.buscarTodosOrgaosOrigem()\n                this.habilitarLoadingGlobal()\n                if (resultado) {\n                    this.orgaosOrigem = resultado.items\n                    this.selecionaOrgaoSeArrayConterApenasUmOrgaoOrigem(this.orgaosOrigem)\n                }\n            },\n            async buscarSetoresOrigem() {\n                this.setoresOrigem = []\n                if (this.distribuicao.orgao) {\n                    this.desabilitarLoadingGlobal()\n                    const resultado = await this.buscarSetoresAlmoxarifado(this.distribuicao.orgao)\n                    this.habilitarLoadingGlobal()\n                    this.setoresOrigem = resultado.items\n                    this.selecionaSetorSeArrayConterApenasUmSetorOrigem(this.setoresOrigem)\n                }\n            },\n            async buscarSetoresDestino() {\n                this.setoresDestino = []\n                if (this.distribuicao.orgao) {\n                    this.desabilitarLoadingGlobal()\n                    const resultado = await this.buscarSetoresNaoAlmoxarifado(this.distribuicao.orgao)\n                    this.habilitarLoadingGlobal()\n                    this.setoresDestino = resultado.items\n                    this.selecionaSetorSeArrayConterApenasUmSetorDestino(this.setoresDestino)\n                }\n            },\n            async buscarResponsaveis() {\n                const resposta = await this.buscarTodosResponsaveis()\n                this.responsaveis = resposta.items\n            },\n            selecionaSetorSeArrayConterApenasUmSetorOrigem(setores) {\n                if (setores.length === 1 && !this.distribuicao.setorOrigem) {\n                    this.distribuicao.setorOrigem = setores[0].id\n                    this.editarDistribuicao()\n                }\n            },\n            selecionaSetorSeArrayConterApenasUmSetorDestino(setores) {\n                if (setores.length === 1 && !this.distribuicao.setorDestino) {\n                    this.distribuicao.setorDestino = setores[0].id\n                    this.editarDistribuicao()\n                }\n            },\n            async selecionaOrgaoSeArrayConterApenasUmOrgaoOrigem(orgaos) {\n                if (orgaos.length === 1 && !this.distribuicao.orgao) {\n                    this.distribuicao.orgao = orgaos[0].id\n                }\n                await this.trataEventoSelecaoDeOrgaoOrigem()\n            },\n            async editarDistribuicao() {\n                this.desabilitarLoadingGlobal()\n                try {\n                    const dadosAtualizados = await this.atualizarDistribuicao(this.distribuicao)\n                    this.setarDadosAtualizados(dadosAtualizados)\n                } catch(err) {\n                    this.mostrarNotificacaoErro(err.response.data.message)\n                    this.$store.commit(mutationTypes.LOKI.DISABLE_AUTO_SAVING)\n                    await this.buscarDistribuicao()\n                } finally {\n                    this.habilitarLoadingGlobal()\n                }\n            },\n            async buscarDistribuicao(){\n                this.desabilitarLoadingGlobal()\n                this.distribuicao = await this.buscarDistribuicaoPorId(this.$route.params.movimentacaoInternaId)\n                this.habilitarLoadingGlobal()\n            },\n            async trataEventoSelecaoDeOrgaoOrigem() {\n                await this.editarDistribuicao()\n                await this.buscarSetoresOrigem()\n                await this.buscarSetoresDestino()\n            },\n            async tratarEventoMudancaOrgaoOrigem(){\n                this.anulaSetoresAoMudarOrgao()\n                this.limparListaSetores()\n                await this.trataEventoSelecaoDeOrgaoOrigem()\n            },\n            anulaSetoresAoMudarOrgao(){\n                this.distribuicao.setorOrigem = null\n                this.distribuicao.setorDestino = null\n            },\n            limparListaSetores() {\n                this.setoresOrigem = []\n                this.setoresDestino = []\n            },\n            setarDadosAtualizados(dados) {\n                this.verificarMudancasPropriedades(dados, this.dadosDeEntrada, this.distribuicao)\n            },\n            alterarValor(chave, valor) {\n                this.distribuicao[chave] = valor\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n.movimentacao-edicao-dados-gerais\n    min-height 62vh\n\n\n.label-motivo\n    font-size 14px\n    font-weight bold\n    color #555555\n    opacity 0.7\n\n</style>\n"]}]}