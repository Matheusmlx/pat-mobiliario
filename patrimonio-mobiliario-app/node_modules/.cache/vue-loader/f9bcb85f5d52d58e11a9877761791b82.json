{"remainingRequest":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/movimentacao/movimentacao-interna/MovimentacaoInternaEdicao.vue?vue&type=style&index=0&id=41882e40&scoped=true&lang=stylus&","dependencies":[{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/movimentacao/movimentacao-interna/MovimentacaoInternaEdicao.vue","mtime":1615564333676},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n>>>\n    .movimentacao-interna-container\n        .v-stepper\n            box-shadow none\n\n            &__content\n                padding 0 15% 0 60%\n\n            &__step__step .v-icon.v-icon\n                font-size .9rem\n\n        .container\n            background-color #fff\n\n        .az-actions-form\n            border-top solid thin rgba(0, 0, 0, .12)\n            padding-top 10px\n            margin-top 0\n\n        &-conteudo\n            min-height 350px\n\n",{"version":3,"sources":["MovimentacaoInternaEdicao.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmXA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA","file":"MovimentacaoInternaEdicao.vue","sourceRoot":"src/views/pages/movimentacao/movimentacao-interna","sourcesContent":["<template>\n    <div>\n        <az-back-button :route=\"{ name: rotaOrigem }\" text=\"Voltar para listagem\"/>\n\n        <az-container class=\"movimentacao-interna-container\">\n            <v-stepper v-model=\"passoAtual.numero\">\n                <v-stepper-header class=\"elevation-0 barra-passo\">\n                    <v-spacer/>\n\n                    <v-stepper-step\n                        :complete=\"passos[0].numero < passoAtual.numero\"\n                        :disabled=\"passos[0].desabilitado\"\n                        :editable=\"!passos[0].desabilitado\"\n                        :key=\"`${passos[0].numero}-header`\"\n                        :step=\"passos[0].numero\"\n                        @click=\"tratarEventoClick(passos[0])\"\n                        edit-icon=\"fas fa-check\">\n                        {{ passos[0].titulo }}\n                    </v-stepper-step>\n\n                    <v-divider/>\n\n                    <v-tooltip\n                        nudge-left=\"10\"\n                        nudge-top=\"-22\"\n                        max-width=\"200\"\n                        top>\n                        <template v-slot:activator=\"{ on }\">\n                            <div v-on=\"on\" v-show=\"passos[1].desabilitado\">\n                                <v-stepper-step\n                                    :complete=\"passos[1].numero < passoAtual.numero\"\n                                    :disabled=\"passos[1].desabilitado\"\n                                    :editable=\"!passos[1].desabilitado\"\n                                    :key=\"`${passos[1].numero}-header`\"\n                                    :step=\"passos[1].numero\"\n                                    @click=\"tratarEventoClick(passos[1])\"\n                                    edit-icon=\"fas fa-check\"\n                                    :class=\"{'passo-ativo' : !passos[1].desabilitado}\"\n                                >{{ passos[1].titulo }}\n                                </v-stepper-step>\n                            </div>\n                            <v-stepper-step\n                                :complete=\"passos[1].numero < passoAtual.numero\"\n                                :disabled=\"passos[1].desabilitado\"\n                                :editable=\"!passos[1].desabilitado\"\n                                :key=\"`${passos[1].numero}-header`\"\n                                :step=\"passos[1].numero\"\n                                @click=\"tratarEventoClick(passos[1])\"\n                                edit-icon=\"fas fa-check\"\n                                v-show=\"!passos[1].desabilitado\"\n                                :class=\"{'passo-ativo' : !passos[1].desabilitado}\"\n                            >{{ passos[1].titulo }}\n                            </v-stepper-step>\n                        </template>\n                        É necessário que todos os campos obrigatórios sejam preenchidos para continuar.\n                    </v-tooltip>\n\n                    <v-divider/>\n\n                    <v-tooltip\n                        nudge-left=\"10\"\n                        nudge-top=\"-20\"\n                        max-width=\"200\"\n                        top>\n                        <template v-slot:activator=\"{ on }\">\n                            <div v-on=\"on\" v-show=\"passos[2].desabilitado && !passos[1].desabilitado\">\n                                <v-stepper-step\n                                    :complete=\"passos[2].numero < passoAtual.numero\"\n                                    :disabled=\"passos[2].desabilitado\"\n                                    :editable=\"!passos[2].desabilitado\"\n                                    :key=\"`${passos[2].numero}-header`\"\n                                    :step=\"passos[2].numero\"\n                                    @click=\"tratarEventoClick(passos[2])\"\n                                    edit-icon=\"fas fa-check\"\n                                    :class=\"{'passo-ativo' : !passos[2].desabilitado}\"\n                                >{{ passos[2].titulo }}\n                                </v-stepper-step>\n                            </div>\n                            <v-stepper-step\n                                :complete=\"passos[2].numero < passoAtual.numero\"\n                                :disabled=\"passos[2].desabilitado\"\n                                :editable=\"!passos[2].desabilitado\"\n                                :key=\"`${passos[2].numero}-header`\"\n                                :step=\"passos[2].numero\"\n                                @click=\"tratarEventoClick(passos[2])\"\n                                edit-icon=\"fas fa-check\"\n                                v-show=\"!passos[2].desabilitado || passos[1].desabilitado\"\n                                :class=\"{'passo-ativo' : !passos[2].desabilitado}\"\n                            >{{ passos[2].titulo }}\n                            </v-stepper-step>\n                        </template>\n                        É necessário que todos os campos obrigatórios sejam preenchidos para continuar.\n                    </v-tooltip>\n\n                    <v-divider/>\n\n                    <v-tooltip\n                        nudge-left=\"10\"\n                        nudge-top=\"-20\"\n                        max-width=\"200\"\n                        top>\n                        <template v-slot:activator=\"{ on }\">\n                            <div v-on=\"on\" v-show=\"passos[3].desabilitado && !passos[2].desabilitado\">\n                                <v-stepper-step\n                                    :complete=\"passos[3].numero < passoAtual.numero\"\n                                    :disabled=\"passos[3].desabilitado\"\n                                    :editable=\"!passos[3].desabilitado\"\n                                    :key=\"`${passos[3].numero}-header`\"\n                                    :step=\"passos[3].numero\"\n                                    @click=\"tratarEventoClick(passos[3])\"\n                                    edit-icon=\"fas fa-check\"\n                                    :class=\"{'passo-ativo' : !passos[3].desabilitado}\"\n                                >{{ passos[3].titulo }}\n                                </v-stepper-step>\n                            </div>\n                            <v-stepper-step\n                                :complete=\"passos[3].numero < passoAtual.numero\"\n                                :disabled=\"passos[3].desabilitado\"\n                                :editable=\"!passos[3].desabilitado\"\n                                :key=\"`${passos[3].numero}-header`\"\n                                :step=\"passos[3].numero\"\n                                @click=\"tratarEventoClick(passos[3])\"\n                                edit-icon=\"fas fa-check\"\n                                v-show=\"!passos[3].desabilitado || passos[2].desabilitado\"\n                                :class=\"{'passo-ativo' : !passos[3].desabilitado}\"\n                            >{{ passos[3].titulo }}\n                            </v-stepper-step>\n                        </template>\n                        É necessário que todos os campos obrigatórios sejam preenchidos para continuar.\n                    </v-tooltip>\n\n                    <v-spacer/>\n                    <div v-if=\"passoAtual.numero !== 1\">\n                        <documento-button :movimentacaoInternaId=\"movimentacaoInternaId\" :visualizacao=\"false\"/>\n                    </div>\n                    <div>\n                        <botao-remover @remover=\"tratarEventoDeletarMovimentacaoInterna\"\n                                       v-if=\"movimentacaoInternaId && verificaPermissaoEdicao\"/>\n                    </div>\n                </v-stepper-header>\n\n                <v-divider/>\n\n                <v-stepper-items>\n                    <v-stepper-content\n                        :key=\"`${passo.numero}-content`\"\n                        :step=\"passo.numero\"\n                        v-for=\"passo in passos\"></v-stepper-content>\n                    <router-view @desabilitaPasso2=\"desabilitaPasso2\"\n                                 @habilitaPasso2=\"habilitaPasso2\"\n                                 @desabilitaPasso3=\"desabilitaPasso3\"\n                                 @habilitaPasso3=\"habilitaPasso3\"\n                                 @desabilitaPasso4=\"desabilitaPasso4\"\n                                 @habilitaPasso4=\"habilitaPasso4\"/>\n                </v-stepper-items>\n            </v-stepper>\n        </az-container>\n    </div>\n</template>\n\n<script>\n    import AzHasPermissions from '@azinformatica/loki/src/utils/AzHasPermissions'\n    import {mutationTypes} from '@/core/constants'\n    import BotaoRemover from '@/views/components/botoes/BotaoRemover'\n    import { mapActions, mapMutations } from 'vuex'\n    import actionTypes from '@/core/constants/actionTypes'\n    import DocumentoButton from '@/views/components/botoes/DocumentoButton.vue'\n\n    export default {\n        name: 'MovimentacaoInternaEdicao',\n        components: {BotaoRemover,DocumentoButton},\n        data() {\n            return {\n                rotaOrigem: this.$store.state.movimentacaointerna.rota.origem,\n                passos: [\n                    {\n                        titulo: 'Tipo',\n                        rotaNovo: 'MovimentacaoInternaNovoTipo',\n                        rotaEdicao: 'MovimentacaoInternaEdicaoTipo',\n                        rotaEdicaoVisualizacao: 'VisualizarMovimentacaoInternaNovoTipo',\n                        desabilitado: false,\n                        numero: 1,\n                    },\n                    {\n                        titulo: 'Dados Gerais',\n                        rotaEdicao: 'MovimentacaoInternaEdicaoDadosGerais',\n                        rotaEdicaoVisualizacao: 'VisualizarMovimentacaoInternaEdicaoDadosGerais',\n                        desabilitado: true,\n                        numero: 2,\n                    },\n                    {\n                        titulo: 'Patrimônios',\n                        rotaEdicao: 'MovimentacaoInternaEdicaoItens',\n                        rotaEdicaoVisualizacao: 'VisualizarMovimentacaoInternaEdicaoItens',\n                        desabilitado: true,\n                        numero: 3,\n                    },\n                    {\n                        titulo: 'Documentos',\n                        rotaEdicao: 'MovimentacaoInternaEdicaoDocumentos',\n                        rotaEdicaoVisualizacao: 'VisualizarMovimentacaoInternaEdicaoDocumentos',\n                        desabilitado: true,\n                        numero: 4,\n                    }\n                ],\n                passoAtual: {numero:3},\n                movimentacaoInternaId: null,\n                tipoAtual:''\n            }\n        },\n        computed: {\n            verificaPermissaoEdicao() {\n                return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Normal'])\n            }\n        },\n        watch: {\n            $route() {\n                this.setMovimentacaoInternaId()\n                this.setPassoAtual(this.$route)\n            },\n            async movimentacaoInternaId(){\n                if(this.movimentacaoInternaId){\n                    this.tipoAtual = await this.buscarTipoMovimentacaoInterna(this.movimentacaoInternaId)\n                    await this.buscarSituacaoMovimentacao()\n                }\n            }\n        },\n        async created() {\n            this.retrairMenu()\n            this.setMovimentacaoInternaId()\n            this.setPassoAtual(this.$route)\n            const situacaoMovimentacao = await this.buscarSituacaoMovimentacao()\n            this.redirecionarSeMovimentacaoInternaNaoPodeSerEditada(situacaoMovimentacao)\n        },\n        async destroyed() {\n            this.expandirMenu()\n            await this.removerMovimentacaoVazia()\n        },\n        methods: {\n            ...mapActions([\n                actionTypes.MOVIMENTACAO_INTERNA.REMOVER_MOVIMENTACAO_INTERNA_COMPLETA,\n                actionTypes.MOVIMENTACAO_INTERNA.REMOVER_MOVIMENTACAO_INTERNA_VAZIA,\n                actionTypes.MOVIMENTACAO_INTERNA.BUSCAR_TIPO_MOVIMENTACAO_INTERNA,\n                actionTypes.MOVIMENTACAO_INTERNA.BUSCAR_SITUACAO_MOVIMENTACAO_INTERNA,\n            ]),\n            ...mapMutations([\n                mutationTypes.MOVIMENTACAO_INTERNA.SET_SITUACAO_MOVIMENTACAO_INTERNA\n            ]),\n            async buscarSituacaoMovimentacao(){\n                if(this.movimentacaoInternaId){\n                    const situacaoMovimentacao = await this.buscarSituacaoMovimentacaoInterna(this.movimentacaoInternaId)\n                    this.setSituacaoMovimentacaoInterna(situacaoMovimentacao)\n                    return situacaoMovimentacao\n                }\n                return null\n            },\n            redirecionarSeMovimentacaoInternaNaoPodeSerEditada(situacaoMovimentacao){\n                if(!['EM_ELABORACAO', 'ERRO_PROCESSAMENTO', null].includes(situacaoMovimentacao)){\n                    this.mostrarNotificacaoErro('Não é possível editar esta movimentação')\n                    this.$router.replace({name: 'MovimentacaoInternaListagem'})\n                }\n            },\n            habilitaPasso2(movimentacaoInternaCadastradaId) {\n                this.passos[1].desabilitado = false\n                if(movimentacaoInternaCadastradaId){\n                    this.movimentacaoInternaId = movimentacaoInternaCadastradaId\n                }\n            },\n            desabilitaPasso2() {\n                this.passos[1].desabilitado = true\n            },\n            habilitaPasso3() {\n                this.passos[2].desabilitado = false\n            },\n            desabilitaPasso3() {\n                this.passos[2].desabilitado = true\n            },\n            habilitaPasso4() {\n                this.passos[3].desabilitado = false\n            },\n            desabilitaPasso4() {\n                this.passos[3].desabilitado = true\n            },\n            expandirMenu() {\n                this.$store.commit(mutationTypes.COMUM.SET_EXPANDIR_MENU)\n            },\n            retrairMenu() {\n                this.$store.commit(mutationTypes.COMUM.SET_RETRAIR_MENU)\n            },\n            setMovimentacaoInternaId() {\n                if(this.$route.params){\n                    this.movimentacaoInternaId = this.$route.params.movimentacaoInternaId\n                }\n            },\n            setPassoAtual(route) {\n                const encontrado = this.passos.filter(\n                    passo =>\n                        passo.rotaNovo === route.name ||\n                        passo.rotaEdicao === route.name ||\n                        passo.rotaEdicaoVisualizacao === route.name\n                )\n                if(encontrado[0]){\n                    this.passoAtual = encontrado[0]\n                }\n                this.contralaAcessoAosPassosEmCadaRota()\n            },\n            contralaAcessoAosPassosEmCadaRota() {\n                if (this.$route.name === 'MovimentacaoInternaNovoTipo' || this.$route.name === 'VisualizarMovimentacaoInternaNovoTipo' ||\n                    this.$route.name === 'MovimentacaoInternaEdicaoTipo' || this.$route.name === 'VisualizarMovimentacaoInternaEdicaoTipo') {\n                    this.passos[1].desabilitado = true\n                }\n                if (this.$route.name === 'MovimentacaoInternaEdicaoDadosGerais' || this.$route.name === 'VisualizarMovimentacaoInternaEdicaoDadosGerais') {\n                    this.passos[1].desabilitado = false\n                    this.passos[2].desabilitado = true\n                    this.passos[3].desabilitado = true\n                }\n                if (this.$route.name === 'MovimentacaoInternaEdicaoItens' || this.$route.name === 'VisualizarMovimentacaoInternaEdicaoItens') {\n                    this.passos[1].desabilitado = false\n                    this.passos[2].desabilitado = false\n                    this.passos[3].desabilitado = true\n                }\n                if (this.$route.name === 'MovimentacaoInternaEdicaoDocumentos' || this.$route.name === 'VisualizarMovimentacaoInternaEdicaoDocumentos') {\n                    this.passos[0].desabilitado = false\n                    this.passos[1].desabilitado = false\n                    this.passos[2].desabilitado = false\n                    this.passos[3].desabilitado = false\n                }\n            },\n            async tratarEventoDeletarMovimentacaoInterna() {\n                await this.removerMovimentacaoInternaCompleta(this.movimentacaoInternaId)\n                this.mostrarNotificacaoSucessoDefault()\n                await this.$router.push({name: this.rotaOrigem})\n            },\n            tratarEventoClick(item) {\n                if (!item.desabilitado) {\n                    if (!this.verificaPermissaoEdicao) {\n                        this.$router.replace({name: item.rotaEdicaoVisualizacao, params: {movimentacaoInternaId: this.movimentacaoInternaId}})\n                    } else {\n                        this.$router.replace({name: item.rotaEdicao, params: {movimentacaoInternaId: this.movimentacaoInternaId}})\n                    }\n                }\n            },\n            async removerMovimentacaoVazia() {\n                const movimentacao = this.$store.state.movimentacaointerna.movimentacaoInterna\n                const movimentacaoExiste = movimentacao && movimentacao.id\n                const movimentacaoEmElaboracao = movimentacao.situacao === 'EM_ELABORACAO'\n                const movimentacaoComAlgumCampoPreenchido = movimentacaoExiste && this.verificarMovimentacaoComAlgumCampoPreenchido(movimentacao)\n                if (movimentacaoExiste && movimentacaoEmElaboracao && !movimentacaoComAlgumCampoPreenchido) {\n                    await this.removerMovimentacaoInternaVazia(movimentacao.id)\n                }\n            },\n            verificarMovimentacaoComAlgumCampoPreenchido(movimentacao) {\n                const keys = Object.keys(movimentacao)\n                const camposPreenchidosAutomaticamente = ['id', 'situacao', 'codigo', 'usuarioCriacao']\n                let possuiCampoPreenchido = false\n                for (let key of keys) {\n                    if (camposPreenchidosAutomaticamente.find(campo => campo === key)) {\n                        continue\n                    }\n                    if (movimentacao[key]) {\n                        possuiCampoPreenchido = true\n                        break\n                    }\n                }\n                return possuiCampoPreenchido\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n>>>\n    .movimentacao-interna-container\n        .v-stepper\n            box-shadow none\n\n            &__content\n                padding 0 15% 0 60%\n\n            &__step__step .v-icon.v-icon\n                font-size .9rem\n\n        .container\n            background-color #fff\n\n        .az-actions-form\n            border-top solid thin rgba(0, 0, 0, .12)\n            padding-top 10px\n            margin-top 0\n\n        &-conteudo\n            min-height 350px\n\n</style>\n"]}]}