{"remainingRequest":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/patrimonios/patrimonio/ficha-patrimonios/movimentacoes/FichaPatrimonioMovimentacoes.vue?vue&type=style&index=0&id=66d99fd4&scoped=true&lang=stylus&","dependencies":[{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/src/views/pages/patrimonios/patrimonio/ficha-patrimonios/movimentacoes/FichaPatrimonioMovimentacoes.vue","mtime":1614091470412},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/matheus/Documentos/patrimonio-mobiliario/patrimonio-mobiliario-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.corpo-conteiner\n    min-height 75vh\n\n.alinhamentoTimeline\n    margin-left auto\n    margin-right auto\n    padding-top 100px !important\n",{"version":3,"sources":["FichaPatrimonioMovimentacoes.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6MA;AACA;;AAEA;AACA;AACA;AACA","file":"FichaPatrimonioMovimentacoes.vue","sourceRoot":"src/views/pages/patrimonios/patrimonio/ficha-patrimonios/movimentacoes","sourcesContent":["<template>\n    <div class=\"corpo-conteiner\">\n            <v-col md=\"7\" sm=\"12\" xs=\"12\" class=\"alinhamentoTimeline\">\n                <v-timeline>\n                    <v-timeline-item\n                        v-for=\"item in movimentacoes\"\n                        :key=\"item.dataFinalizacao\"\n                        :color=\"retornaCor(item)\"\n                        :icon=\"retornaIcone(item)\"\n                        fill-dot small>\n                        <template v-slot:opposite>\n                            <span\n                                class=\"text-left text--darken-1 grey--text text-body-2\">{{ retornaData(item) | azDate() }}</span>\n                        </template>\n                        <v-card v-if=\"movimentacaoIncorporacao(item)\"\n                            width=\"350\"\n                                @click=\"redirecionaRegistroIncorporacao(item)\">\n                            <v-card-title\n                                class=\"font-weight-bold text-body-1 pb-0 text--darken-1 primary--text\">\n                                {{ item.tipo | azEnum(tipoMovimentacoes) }}\n                            </v-card-title>\n                            <v-card-text class=\"text-left text--darken-1 grey--text\">\n                                <span class=\"font-weight-bold\">N° Nota: </span>{{ item.numeroNotaLancamentoContabil | textoSemValorSimples }}<br/>\n                                <span class=\"font-weight-bold\">Valor Total: </span>{{ item.valorTotal | valorParaReal }}<br/>\n                                <span class=\"font-weight-bold\">Situação: </span>{{ item.situacao | azEnum(situacoesIncorporacao) }}<br/>\n                            </v-card-text>\n                        </v-card>\n\n                        <v-card width=\"350\"\n                                v-else\n                                @click=\"redirecionaRegistroMovimentacao(item)\">\n                            <v-card-title\n                                class=\"font-weight-bold text-body-1 pb-0 text--darken-1\" :class=\"[movimentacaoEmElaboracao(item)? 'orange--text': 'primary--text']\">\n                                {{ item.tipo | azEnum(tipoMovimentacoes) }}\n                            </v-card-title>\n                            <v-card-text class=\"text-left text--darken-1 grey--text\">\n                                <span class=\"font-weight-bold\">De: </span>{{ item.setorOrigem | textoSemValorSimples }}<br/>\n                                <span class=\"font-weight-bold\">Para: </span>{{ item.setorDestino | textoSemValorSimples }}<br/>\n                                <span class=\"font-weight-bold\">Situação: </span>{{ item.situacao | azEnum(situacoesMovimentacaoInterna) }}<br/>\n                            </v-card-text>\n                        </v-card>\n                    </v-timeline-item>\n                </v-timeline>\n            </v-col>\n        <v-col v-if=\"mostraBotoes\" md=\"12\" sm=\"12\" xs=\"12\" class=\"d-flex justify-center align-center\">\n            <botao-ver-mais v-if=\"mostraVerMais\" @verMais=\"tratarEventoVerMais\" />\n            <botao-ver-menos v-else @verMenos=\"tratarEventoVerMenos\" />\n        </v-col>\n    </div>\n</template>\n\n<script>\n    import {createNamespacedHelpers, mapActions} from 'vuex'\n    import _ from 'lodash'\n    import {actionTypes} from '@/core/constants'\n    import AzHasPermissions from '@azinformatica/loki/src/utils/AzHasPermissions'\n    import BotaoVerMais from '@/views/components/botoes/BotaoVerMais'\n    import BotaoVerMenos from '@/views/components/botoes/BotaoVerMenos'\n\n    const {mapGetters} = createNamespacedHelpers('rotulosPersonalizados')\n\n    export default {\n        name: 'FichaPatrimonioMovimentacoes',\n        components: {BotaoVerMenos, BotaoVerMais},\n        props: {\n            dadosIncorporacao: {\n                type: Object,\n                required: true\n            }\n        },\n        data() {\n            return {\n                movimentacoes: [],\n                todasMovimentacoes: [],\n                cincoMovimentacoes: [],\n                incorporacao:{},\n                situacoesSemAlteracao: ['FINALIZADO','DEVOLVIDO','ESTORNADO','PARCIALMENTE_ESTORNADO'],\n                nomeTelaDadosGerais: 'MOVIMENTACAO_INTERNA_DADOS_GERAIS',\n                nomeTelaIncorporacao: 'INCORPORACAO_DADOS_GERAIS'\n            }\n        },\n        watch: {\n            'dadosIncorporacao'() {\n                this.preencherIncorporacao()\n                this.buscarMovimentacoes()\n            }\n        },\n        mounted() {\n            this.buscarIncorporacao()\n        },\n        computed: {\n            ...mapGetters(['getDistribuicaoValidado']),\n            verificaPermissaoEdicao() {\n                return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Normal'])\n            },\n            verificaPermissaoEdicaoMovimentacao() {\n                return AzHasPermissions(this.$store.state.loki.user.authorities, ['Mobiliario.Movimentacoes'])\n            },\n            mostraVerMais(){\n                return this.movimentacoes.length <= 5\n            },\n            mostraBotoes(){\n                return this.todasMovimentacoes.length > 5\n            }\n        },\n        methods: {\n            ...mapActions([\n                actionTypes.PATRIMONIO.BUSCAR_TODAS_MOVIMENTACOES,\n                actionTypes.MOVIMENTACAO_INTERNA.ITEM.BUSCAR_QUATIDADE_ITENS_ADICIONADOS_MOVIMENTACAO_INTERNA\n            ]),\n            buscarIncorporacao() {\n                this.$emit('buscarIncorporacao')\n            },\n            preencherIncorporacao() {\n                this.incorporacao = _.cloneDeep(this.dadosIncorporacao)\n            },\n            redirecionaRegistroIncorporacao(item) {\n                if(this.verificaPermissaoEdicao){\n                    this.$router.push({name: 'VisualizarRegistroIncorporacao', params:{incorporacaoId:item.incorporacaoId}})\n                }else{\n                    this.$router.push({name: 'VisualizarRegistroIncorporacaoVisualizacao', params: {incorporacaoId: item.incorporacaoId}})\n                }\n            },\n            async redirecionaRegistroMovimentacao(item) {\n                if (this.verificaPermissaoEdicaoMovimentacao) {\n                    const id = item.id\n                    if (item.situacao === 'FINALIZADO' || item.situacao === 'AGUARDANDO_DEVOLUCAO' || item.situacao === 'DEVOLVIDO') {\n                        await this.$router.push({name: 'VisualizarRegistroMovimentacaoInterna', params: {movimentacaoInternaId: id}})\n                    }\n                    else if (item.situacao === 'EM_ELABORACAO') {\n                        if (await this.verificarSeCamposObrigatoriosPreenchidos(item)) {\n                            if (await this.verificarSePossuiItensNaMovimentacao(id)) {\n                                this.redirecionaParaDocumentos(id)\n                            } else {\n                                this.redirecionaParaItens(id)\n                            }\n                        } else {\n                            this.redirecionaParaDadosGerais(id)\n                        }\n                    }\n                }\n            },\n            async verificarSeCamposObrigatoriosPreenchidos(item) {\n                if(item.tipo === 'DISTRIBUICAO'){\n                    return await this.getDistribuicaoValidado(item, this.nomeTelaDadosGerais, this.nomeTelaIncorporacao)\n                }\n                return false\n            },\n            async verificarSePossuiItensNaMovimentacao(id) {\n                const resultado = await this.buscarQuantidadeItensAdicionadosMovimentacaoInterna(id)\n                return resultado ? (resultado.quantidadeItens > 0) : false\n            },\n            redirecionaParaDocumentos(id) {\n                this.$router.push({name: 'MovimentacaoInternaEdicaoDocumentos', params: {movimentacaoInternaId: id}})\n            },\n            redirecionaParaItens(id) {\n                this.$router.push({name: 'MovimentacaoInternaEdicaoItens', params: {movimentacaoInternaId: id}})\n            },\n            redirecionaParaDadosGerais(id) {\n                this.$router.push({name: 'MovimentacaoInternaEdicaoDadosGerais', params: {movimentacaoInternaId: id}})\n            },\n            async buscarMovimentacoes(){\n                const retorno = await this.buscarTodasMovimentacoes(this.$route.params.patrimonioId)\n                if (!this.incorporacao.isEmpty) {\n                    retorno.items.push(this.incorporacao)\n                }\n                if(retorno && retorno.items.length > 0){\n                    this.verificaQuantidadeMovimentacoes(retorno.items)\n                }\n            },\n            verificaQuantidadeMovimentacoes(movimentacoes){\n                this.todasMovimentacoes = movimentacoes\n                this.cincoMovimentacoes = movimentacoes.slice(0, 5)\n                if(movimentacoes.length > 5){\n                    this.movimentacoes = this.cincoMovimentacoes\n                }else{\n                    this.movimentacoes = this.todasMovimentacoes\n                }\n            },\n            tratarEventoVerMais(){\n                this.movimentacoes = this.todasMovimentacoes\n            },\n            tratarEventoVerMenos(){\n                this.movimentacoes = this.cincoMovimentacoes\n            },\n            retornaIcone(item){\n                return this.situacoesSemAlteracao.includes(item.situacao) ? 'done' : 'priority_high'\n            },\n            retornaCor(item){\n                return this.situacoesSemAlteracao.includes(item.situacao) ? 'primary' : 'orange'\n            },\n            movimentacaoIncorporacao(item){\n                return item.tipo === 'INCORPORACAO'\n            },\n            movimentacaoEmElaboracao(item) {\n                return item.situacao === 'EM_ELABORACAO'\n            },\n            retornaData(item){\n                return item.situacao === 'FINALIZADO' ||  item.situacao === 'DEVOLVIDO' ? item.dataFinalizacao : item.dataCriacao\n            }\n        }\n    }\n</script>\n\n<style scoped lang=\"stylus\">\n.corpo-conteiner\n    min-height 75vh\n\n.alinhamentoTimeline\n    margin-left auto\n    margin-right auto\n    padding-top 100px !important\n</style>\n"]}]}